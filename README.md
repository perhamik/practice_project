Управление воротами при помощи двигателя, индуктивных датчиков и электромагнита<br />

Описание:<br />
  Подключение:<br />
    2 пин Arduino - управляющий сигнал (по умолчанию на ножке +5В, замыкая на землю - разрешаем управление)<br />
    3 пин Arduino - отладочная кнопка<br />
    4 пин Arduino - кнопка №1<br />
    5 пин Arduino - кнопка №2<br />
    6 пин Arduino - индуктивный датчик на воротах с магнитом (состояние: LOW - ворота закрыты, HIGH - открыты)<br />
    7 пин Arduino - индуктивный датчик на воротах с двигателем (состояние: LOW - ворота закрыты, HIGH - открыты)<br />
    8 пин Arduino - индуктивный датчик на воротах с двигателем (состояние: LOW - ворота открыты, HIGH - закрыты)<br />
    10 пин Arduino - выход на реле управление двигателем<br />
    11 пин Arduino - выход на реле управление магнитом<br />
    
  Работа кнопок:<br />
    Обе кнопки работают по отпусканию. Последовательность кнопок имеет значение.
    Сначала должна быть нажата и отпущенна кнопка №1, а затем (в течении 3-х секунд) кнопка №2.
    Иначе, нажатие не засчитывается.
    
  Работа датчиков:
    Датчики реагируют на изменение индуктивности на расстоянии 4 см от себя.
    Корпус устройства из стали, поэтому датчик и регистрирует событие.
    При наличии преграды состояние: LOW, иначе HIGH.
    Один датчик используется для отслеживания состояния двери с магнитом (открытой/закрытой).
    Остальные два для регистрации положения двери с двигателем, так как необходимо вовремя выключать двигатель.
  
  Старт програмы:
    Прогон двигателя в один проход.
    Если зажата кнопка №1, делаем прогрев двигателя (20 повторов)
  
  Основной цикл:
    Програма имеет 6 состояний:
    0: ожидание
    1: открытие ворот двигателем
    2: открытие ворот магнитом
    3: проверка открытия магнитом (нет - переход к состоянию 2, да - к состоянию 4)
    4: ожидание возврата двери и включение магнита, затем задержка 1 сек, и включение двигателя
    5: выключение двигателя, проверка всех датчиков и переход в исходное состояние (иначе - к состоянию 4)
    
-----------------------------------------------------------------------------------------------------------------
Ferma.ino - версия програмы 1.0
Ferma_5_min.ino - тестовый скетч на 5 минут безпрерывной работы
Ferma_v_2_0.ino - версия програмы 2.0
Ferma_v_2_1.ino - версия програмы 2.1
Ferma_v_2_2.ino - версия програмы 2.2
Ferma_v_2_3.ino - версия програмы 2.3
Ferma_v_2_4.ino - версия програмы 2.4 (последння)

-----------------------------------------------------------------------------------------------------------------
История версий:
-----------------------------------------------------------------------------------------------------------------
  2.0
    -уменьшение времени открытия двери двигателем
    -исправлена ошибка с невозвратом в исходное положение после автозакрытия
    -отслеживания открытия двери двигателем перенесено в состояние 1
    -включение магнита перенесено в отдельную функцию (магнит включается только по датчику)
    -состояние 4 переделано, таймер автозакрытия объеденён с аварийным
    -время контроля кнопок уменьшено с 10 с до 3 с
    
  2.1
    -добавлена сервисная кнопка на пине 3
    -добавлена функция "прогрева" двигателя в 20 повторений (при нажатии сервисной кнопки)
    -добавлена задержка до выключения магнита (для синхронизации нескольки устройств)
    -время синхронизации отслеживается по срабатыванию кнопок
    
  2.2
    -добавлено включение магнита при автозакрытии (ранее включался через 3 секунды)   
    
  2.3
    -сервисная кнопка привязана к прерыванию
    -удалены неиспользуемые переменные
    -почищен код
    
  2.4
    -добавлена защита от дребезга контактов
    -константы переписаны в #define
    -сервисная кнопка объеденина с кнопкой №1
    -"прогрев" возможно запустить только при старте микроконтролера
    -исправлены ошибки при "зависании"  в состоянии 5    
